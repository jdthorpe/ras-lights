"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[702],{79975:function(e,n,t){t.r(n),t.d(n,{default:function(){return re}});var r,i,s,a,c,o,u,l=t(47476),d=t(74812),h=t(18487),f=t(41004),p=t(32951),x=t.n(p),g=t(48934),m=t(71876),y=t(23408),b=t(34878),j=t(67872),v=t(86776),S=t(54329),k=t(22340),Z=t(63660),C=t(72905),w=t(1430),P=t(9812),R=t(20742),T=t(38639),_={main:{maxWidth:450}},W=C.ZP.table(r||(r=(0,l.Z)(["\n    border-collapse: collapse;\n    tr:nth-child(even) {background: #DDD};\n    tr:nth-child(odd) {background: #FFF};\n"]))),B=C.ZP.th(i||(i=(0,l.Z)(["\n    border: 1px solid #999;\n    padding: 0.5rem;\n    text-align: left;\n"]))),I=C.ZP.td(s||(s=(0,l.Z)(["\n    border: 1px solid #999;\n    padding: 0.5rem;\n    text-align: left;\n"]))),G={type:g.i.normal,title:"Are you sure?",closeButtonAriaLabel:"Close",subText:"Are you sure you want to delete this library?"},L="Required field",D=function(e){var n=e.update,t=(0,d.useState)(!0),r=(0,f.Z)(t,2),i=r[0],s=r[1],a=(0,d.useState)(),c=(0,f.Z)(a,2),o=c[0],u=c[1],l=(0,d.useState)(),p=(0,f.Z)(l,2),g=p[0],m=p[1],y=(0,d.useState)(),b=(0,f.Z)(y,2),j=b[0],S=b[1],k=(0,d.useState)(),C=(0,f.Z)(k,2),R=C[0],_=C[1],W=(0,d.useState)(),B=(0,f.Z)(W,2),G=B[0],D=B[1],E=(0,d.useCallback)((function(e,n){S(n),s(!0),R===L&&n&&n.length&&_(void 0)}),[S,R]),M=(0,d.useCallback)((function(e,n){u(n),s(!0),g===L&&n&&n.length&&m(void 0)}),[g]),K=(0,d.useCallback)((0,h.Z)(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:if(j||_(L),o||m(L),j&&o){e.next=6;break}return e.abrupt("return");case 6:return s(!1),e.prev=7,e.next=10,Z.r$({type:"LIBRARY",name:o,path:j});case 10:D(void 0),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(7),D(e.t0.message||"Something went wrong");case 16:n();case 17:case"end":return e.stop()}}),e,null,[[7,13]])}))),[o,j,i,s,n]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("tr",{children:[(0,T.jsx)(I,{children:(0,T.jsx)(v.n,{onChange:M,errorMessage:g})}),(0,T.jsx)(I,{children:(0,T.jsx)(v.n,{onChange:E,errorMessage:R})}),(0,T.jsx)(I,{children:(0,T.jsx)(w.G,{style:{margin:"0 7px",color:i?"black":"grey"},icon:P.r8p,title:"Add",onClick:K})})]}),G&&(0,T.jsxs)("p",{style:{color:"red"},children:["Somethig went wrong while saving: ",G]})]})},E=function(e){var n=e.lib,t=e.rowkey,r=e.update,i=(0,d.useState)(!0),s=(0,f.Z)(i,2),a=s[0],c=s[1],o=(0,R.k)(!0),u=(0,f.Z)(o,2),l=u[0],p=u[1].toggle;(0,d.useEffect)((function(){return function(){return c(!0)}}),[c,n]);var g=(0,d.useCallback)((0,h.Z)(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return c(!1),e.next=5,Z.HG(n.name);case 5:r();case 6:case"end":return e.stop()}}),e)}))),[n,a,r]);return(0,T.jsxs)("tr",{children:[(0,T.jsx)(I,{children:n.name}),(0,T.jsx)(I,{children:n.path}),(0,T.jsx)(I,{children:(0,T.jsx)(w.G,{style:{margin:"0 7px",color:a?"black":"grey"},icon:P.I7k,title:"Delete",onClick:p})}),(0,T.jsx)(m.V,{hidden:l,onDismiss:p,dialogContentProps:G,modalProps:{isBlocking:!1,styles:_},children:(0,T.jsxs)(y.c,{children:[(0,T.jsx)(b.K,{onClick:function(){p(),g()},text:"Delete"}),(0,T.jsx)(j.a,{onClick:p,text:"Cancel"})]})})]},t)},M=function(){var e=(0,d.useState)(),n=(0,f.Z)(e,2),t=n[0],r=n[1],i=function(){var e=(0,h.Z)(x().mark((function e(){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.wZ();case 2:n=e.sent,r(n.sort((function(e,n){return e.name<n.name?-1:1})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,d.useEffect)((function(){"undefined"===typeof t&&i()}),[t]),"undefined"===typeof t?(0,T.jsx)("div",{children:(0,T.jsx)(S.$,{label:"Loading Libraries...",size:k.E.large})}):(0,T.jsxs)("div",{children:[(0,T.jsx)("h2",{children:"Library Folders"}),(0,T.jsxs)(W,{children:[(0,T.jsxs)("colgroup",{children:[(0,T.jsx)("col",{style:{minWidth:"6rem"}}),(0,T.jsx)("col",{style:{minWidth:"20rem"}}),(0,T.jsx)("col",{style:{width:"3rem"}})]}),(0,T.jsx)("thead",{children:(0,T.jsxs)("tr",{children:[(0,T.jsx)(B,{children:"Name"}),(0,T.jsx)(B,{children:"Path"}),(0,T.jsx)(B,{})]})}),(0,T.jsxs)("tbody",{children:[t.map((function(e,n){return(0,T.jsx)(E,{lib:e,rowkey:n,update:i},n)})),(0,T.jsx)(D,{update:i})]})]})]})},K=t(78464),F=t(26494),O=t(26975),q=t(55977),A=t(62839),N=t(21322),$=t.n(N),z=t(30099),H=C.ZP.div(a||(a=(0,l.Z)(["\n    display: flex;\n    flex-direction: Row;\n    gap: 1rem;\n"]))),J=C.ZP.div(c||(c=(0,l.Z)(["\n    display: flex;\n    flex-direction: Row;\n    border-radius: 5px;\n    gap: 1rem;\n    padding-left: 12px;\n    padding-right: 12px;\n"]))),U=["PWM0","PWM1","PCM_DOUT","SPI0-MOSI"],V=function(e){var n=e.pins,t=e.channel,r=e.onChange,i=(0,d.useState)(t.brightness),s=(0,f.Z)(i,2),a=s[0],c=s[1],o=(0,d.useState)(t.count),u=(0,f.Z)(o,2),l=u[0],h=u[1],p=(0,d.useState)(t.gpio),x=(0,f.Z)(p,2),g=x[0],m=x[1],y=(0,d.useState)(t.type),b=(0,f.Z)(y,2),j=b[0],v=b[1],S=(0,d.useState)(t.invert),k=(0,f.Z)(S,2),Z=k[0],C=k[1],w=(0,d.useState)(t.reverse),P=(0,f.Z)(w,2),R=P[0],_=P[1];return(0,d.useEffect)((function(){r({brightness:a,count:l,gpio:g,type:j,invert:Z,reverse:R})}),[a,l,g,j,Z,R]),(0,d.useEffect)((function(){c(t.brightness),h(t.count),m(t.gpio),v(t.type)}),[t]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(F.L,{label:"GPIO",styles:{root:{minWidth:"5rem",maxWidth:"5rem"}},options:n.map((function(e){return{key:e,text:"".concat(e)}})),selectedKey:g,onChange:function(e,n,t){e&&n&&m(n.key)}}),(0,T.jsx)(z.M,{label:"Brightness",value:a,min:0,max:255,onChange:c}),(0,T.jsx)(z.M,{label:"Count",value:l,min:0,onChange:h}),(0,T.jsx)(O.Z,{label:"Invert",checked:Z,onChange:function(e,n){return"undefined"!==typeof n&&C(n)}}),(0,T.jsx)(O.Z,{label:"Reverse",checked:R,onChange:function(e,n){return"undefined"!==typeof n&&_(n)}}),(0,T.jsx)(F.L,{label:"Strip Type",styles:{root:{minWidth:"11rem",maxWidth:"11rem"}},options:Y.map((function(e){return{key:e,text:e}})),selectedKey:j,onChange:function(e,n,t){n&&v(n.key)}})]})},Y=["WS2811_STRIP_RGB","WS2811_STRIP_RBG","WS2811_STRIP_GBR","WS2811_STRIP_GRB","WS2811_STRIP_BRG","WS2811_STRIP_BGR","K6812_STRIP_RGBW","SK6812_STRIP_RBGW","SK6812_STRIP_GBRW","SK6812_STRIP_GRBW","SK6812_STRIP_BRGW","SK6812_STRIP_BGRW"],Q=[[12,18,40,52],[13,19,41,45,53],[21,31],[10,38]],X=function(){var e=(0,d.useState)(),n=(0,f.Z)(e,2),t=n[0],r=n[1],i=(0,d.useState)(!1),s=(0,f.Z)(i,2),a=s[0],c=s[1],o=(0,d.useState)(10),u=(0,f.Z)(o,2),l=u[0],p=u[1],g=(0,d.useState)(8e5),m=(0,f.Z)(g,2),y=m[0],j=m[1],v=(0,d.useState)([]),S=(0,f.Z)(v,2),k=S[0],Z=S[1];(0,d.useEffect)((function(){console.log("Driver mounting");var e=!1;return(0,h.Z)(x().mark((function n(){var t,i,s,a;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("/api/driver/");case 3:if(t=n.sent,!e){n.next=6;break}return n.abrupt("return");case 6:return n.next=8,t.json();case 8:if(i=n.sent,!e){n.next=11;break}return n.abrupt("return");case 11:if(null!==i){n.next=16;break}return s={gpio:Q[0][0],count:1,brightness:255,type:Y[0],invert:!1,reverse:!1},r({frequency:8e5,dma:10,channels:[s]}),Z([s]),n.abrupt("return");case 16:r(i),j(i.frequency),i.channels&&i.channels.length?Z(i.channels):(a={gpio:Q[0][0],count:1,brightness:255,type:Y[0],invert:!1,reverse:!1},Z([a])),p(i.dma),n.next=25;break;case 22:n.prev=22,n.t0=n.catch(0),console.log("dB driver error: ",n.t0);case 25:case"end":return n.stop()}}),n,null,[[0,22]])})))(),function(){e=!0}}),[]);var C=(0,d.useCallback)((function(e,n){Z([].concat((0,K.Z)(k.slice(0,n)),[e],(0,K.Z)(k.slice(n+1))))}),[k]);(0,d.useEffect)((function(){c(!$()(t,{frequency:y,dma:l,channels:k}))}),[t,y,l,k]);var w=(0,d.useCallback)((0,h.Z)(x().mark((function e(){var n,t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!1,t={frequency:y,dma:l,channels:k},e.next=4,fetch("/api/driver/",{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 4:if(!n){e.next=6;break}return e.abrupt("return");case 6:return r(t),e.abrupt("return",(function(){return n=!0}));case 8:case"end":return e.stop()}}),e)}))),[y,l,k]),R=(0,d.useCallback)((function(){var e={gpio:Q[k.length][0],count:1,brightness:255,type:Y[0],invert:!1,reverse:!1};Z([].concat((0,K.Z)(k),[e]))}),[k]),_=(0,d.useCallback)((function(){Z(k.slice(0,-1))}),[k]);return t?(0,T.jsxs)("div",{children:[(0,T.jsxs)(H,{style:{alignItems:"flex-end"},children:[(0,T.jsx)("h2",{children:"Driver Settings"}),(0,T.jsx)("p",{style:{color:"grey"},children:(0,T.jsxs)("a",{href:"https://github.com/dsyomichev/rpi-ws281x-led#driver-configuration",children:["See the ",(0,T.jsx)("span",{style:{fontFamily:"monospace"},children:"rpi-ws281x-led"})," library for details"]})})]}),(0,T.jsxs)(J,{children:[(0,T.jsx)(z.M,{label:"Frequency",min:0,value:y,onChange:j}),(0,T.jsx)(z.M,{label:"dma",value:l,min:0,onChange:p}),(0,T.jsx)(b.K,{label:"Save",onClick:w,disabled:!a,style:{alignSelf:"flex-end",marginLeft:"auto"},children:"Save"})]}),(0,T.jsx)("h3",{style:{marginTop:"1.5rem"},children:"Light Strips"}),k&&k.map((function(e,n){return(0,T.jsxs)(J,{style:{backgroundColor:n%2?"#dddddd":"none"},children:[(0,T.jsx)(V,{pins:Q[n],channel:e,onChange:function(e){return C(e,n)}}),(0,T.jsxs)("div",{children:[(0,T.jsx)(q._,{children:"Pin\xa0Mode"}),(0,T.jsx)("p",{children:U[n]})]}),(0,T.jsx)("div",{style:{alignSelf:"center",marginLeft:"auto"},children:n===k.length-1&&n<3&&(0,T.jsx)(A.h,{onClick:R,title:"Add Strand",icon:P.r8p})}),(0,T.jsx)("div",{style:{alignSelf:"center"},children:n===k.length-1&&n>0&&(0,T.jsx)(A.h,{onClick:_,title:"Delete strand",icon:P.I7k})})]},n)}))]}):(0,T.jsx)("div",{children:(0,T.jsx)("p",{children:"Loading..."})})},ee=t(93639),ne=C.ZP.div(o||(o=(0,l.Z)(["\n    display: flex;\n    flex-direction: Column;\n    gap: 1rem;\n    margin: 1rem;\n    max-width: 1000px;\n"]))),te=C.ZP.div(u||(u=(0,l.Z)(["\n    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);\n    padding: 1.5rem;\n"]))),re=function(){return(0,T.jsxs)(ne,{children:[(0,T.jsx)(te,{children:(0,T.jsx)(ee.Z,{})}),(0,T.jsx)(te,{children:(0,T.jsx)(X,{})}),(0,T.jsx)(te,{style:{marginBottom:"2rem"},children:(0,T.jsx)(M,{})})]})}},63660:function(e,n,t){t.d(n,{wZ:function(){return a},r$:function(){return o},HG:function(){return l}});var r=t(18487),i=t(32951),s=t.n(i);function a(){return c.apply(this,arguments)}function c(){return(c=(0,r.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/lib/");case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function o(e){return u.apply(this,arguments)}function u(){return(u=(0,r.Z)(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/lib/",{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return d.apply(this,arguments)}function d(){return(d=(0,r.Z)(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/lib/".concat(n),{method:"DELETE",cache:"no-cache"});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},62839:function(e,n,t){t.d(n,{h:function(){return l}});var r,i=t(25571),s=t(47476),a=(t(74812),t(72905)),c=t(1430),o=t(38639),u=a.ZP.div(r||(r=(0,s.Z)(["\n    width: 2rem;\n    height: 2rem;\n    font-size: 1.2rem;\n    border-radius: 2px;\n    background: grey;\n    padding-top: 0.4rem;\n"]))),l=function(e){var n=e.icon,t=e.title,r=e.onClick,s=e.style,a=e.buttonStyle,l=e.iconStyle;return(0,o.jsx)(u,{onClick:r,style:(0,i.Z)((0,i.Z)({},s),a),children:(0,o.jsx)(c.G,{title:t,style:(0,i.Z)((0,i.Z)({margin:"auto",display:"block"},s),l),icon:n})})}},56714:function(e,n,t){t.d(n,{L:function(){return s}});var r=t(74812),i=t(3218),s=function(){var e=(0,i.B)({});return r.useEffect((function(){return function(){for(var n=0,t=Object.keys(e);n<t.length;n++){var r=t[n];clearTimeout(r)}}}),[e]),(0,i.B)({setTimeout:function(e){function n(n,t){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}((function(n,t){var r=setTimeout(n,t);return e[r]=1,r})),clearTimeout:function(e){function n(n){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}((function(n){delete e[n],clearTimeout(n)}))})}}}]);
//# sourceMappingURL=702.ed72d0d5.chunk.js.map